trigger:
  branches:
    include:
      - main   # or 'master', or your main branch

pool:
  vmImage: 'ubuntu-latest'

steps:
# Install Node.js
- task: NodeTool@0
  inputs:
    versionSpec: '18.x'  # use the Node version your project requires
  displayName: 'Install Node.js'

# Install dependencies & build
- script: |
    npm install
    npm run build
  displayName: 'Install dependencies & build'

# Run tests
- script: |
    CI=true npm test -- --watchAll=false --passWithNoTests
  displayName: 'Run unit tests'

# Publish build artifacts (optional, for deployment)
- task: CopyFiles@2
  inputs:
    SourceFolder: 'build'
    Contents: '**'
    TargetFolder: '$(Build.ArtifactStagingDirectory)'

- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: '$(Build.ArtifactStagingDirectory)'
    ArtifactName: 'drop'